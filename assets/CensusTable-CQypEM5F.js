import{U as T,d as S,B as $,o as a,c as r,t as u,e as f,V as U,W as V,r as _,K as O,X as Q,Y as X,Z,$ as G,a as e,m as w,F as R,x as P,w as B,g as W,J as I,P as ee,k as b,z as E,A as M,y as te,_ as L,a0 as se,s as q,a1 as ne,I as ae,a2 as oe,i as le,a3 as re,a4 as ie,a5 as ue}from"./main-B6dDMunI.js";import{R as de,t as ce,P as ve}from"./Pagination-IfTqpBo8.js";import{a as pe}from"./censusSubmission-D5u_gUei.js";import{a as _e}from"./delay-bYoexC4a.js";function he(e){const a=e.slice(1,-1).split(" ");return{link:a[0],text:a[1]}}function me(e){const a=e.slice(2,-2).split("|");return{link:`${T}${a[0]}`,text:a[1]}}function ye(e){return e.startsWith("[http")?he(e):e.startsWith("[[")?me(e):{link:e,text:e}}const fe=["href"],D=S({__name:"LinkItem",props:{wikitext:{},text:{}},setup(e){const t=e,l=$((()=>t.wikitext.startsWith("[")?ye(t.wikitext):{text:t.wikitext,link:`${T}${t.wikitext}`}));return(e,t)=>(a(),r("a",{href:l.value.link,rel:"noopener noreferrer",target:"_blank"},u(e.text??l.value.text),9,fe))}}),Ce=["href"],A=S({__name:"NewBaseButton",props:{text:{},entry:{}},setup:e=>(e,t)=>(a(),r("a",{href:`./form.html?new=${f(U)(e.entry.CensusPlayer)}`,role:"button",onClick:t[0]||(t[0]=a=>f(V)(e.entry))},u(e.text),9,Ce))}),F=e=>(E("data-v-05a63384"),e=e(),M(),e),ge={class:"text-bold"},we={key:0,class:"text-center"},ke=F((()=>e("p",null,"There's currently only one base on the wiki.",-1))),be={class:"base-item"},$e=["for"],Re=["id","value"],Se=["href"],Be={key:3},xe={key:4},Pe=F((()=>e("button",{class:"secondary"},"Cancel",-1))),Ie=S({__name:"ChangeCensusBase",props:{entry:{},items:{}},emits:["close","ready"],setup(t,{emit:l}){const s=t,n=$((()=>s.entry.Name)),i=_(s.items??[]),o=_(!1),d=_(n.value),v=_(""),c=l;function y(){d.value!==n.value&&pe(s.entry,d.value,v.value)}return O((async()=>{if(!i.value.length)try{const e=await Q(X(s.entry.CensusPlayer,Z));if(!G(e))return void(o.value=!0);i.value=e.cargoquery.map((e=>e.title.Name)),c("ready",i.value),o.value=!1}catch(e){o.value=!0,console.error("Something went wrong:",e)}})),(t,l)=>(a(),r("article",null,[e("header",ge,"Change Census Base for "+u(t.entry.CensusPlayer),1),1===i.value.length?(a(),r("div",we,[ke,w(A,{entry:t.entry,text:"Create New Base"},null,8,["entry"])])):i.value.length?(a(),r(R,{key:1},[(a(!0),r(R,null,P(i.value,(t=>(a(),r("div",be,[e("label",{for:t,class:"base-selector"},[B(e("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),id:t,value:t,name:"bases",type:"radio"},null,8,Re),[[te,d.value]]),e("span",null,u(t),1)],8,$e),e("a",{href:f(_e)(t),rel:"noopener noreferrer",target:"_blank"},"View Wiki Page",8,Se)])))),256)),B(e("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>v.value=e),"aria-label":"Reason",class:"reason-input",placeholder:"Reason",type:"text"},null,512),[[W,v.value]])],64)):o.value?(a(),r("p",Be,"Something went wrong!")):(a(),I(ee,{key:2})),i.value.length>1?(a(),r("footer",xe,[e("form",{method:"dialog",onSubmit:l[2]||(l[2]=e=>t.$emit("close"))},[e("button",{onClick:y},"Submit"),Pe],32)])):b("",!0)]))}}),Ee=L(Ie,[["__scopeId","data-v-05a63384"]]),y=e=>(E("data-v-47e411c5"),e=e(),M(),e),Me={class:"census-item"},Le={class:"player-name text-bold"},Ne={class:"table-items"},De={key:0},Te=y((()=>e("div",{class:"heading"},"Discord:",-1))),Ue={key:1},Ve=y((()=>e("div",{class:"heading"},"Social Media:",-1))),We={class:"link is-social"},qe={key:2},Ae=y((()=>e("div",{class:"heading"},"Friend Code:",-1))),Fe={class:"friend-code"},ze=y((()=>e("div",{class:"heading"},"Base:",-1))),je={class:"link"},Ye=y((()=>e("div",{class:"heading"},"System:",-1))),He=y((()=>e("div",{class:"heading"},"Platform:",-1))),Je=y((()=>e("div",{class:"heading"},"Mode:",-1))),Ke=y((()=>e("div",{class:"heading"},"Arrival:",-1))),Oe=y((()=>e("summary",{role:"button"},"Actions",-1))),Qe={class:"action-buttons"},Xe=["data-tooltip"],Ze=["href"],Ge=S({__name:"CensusItem",props:{entry:{}},setup(t){const l=t,s=_(null),n=_(!1),i=se(),{triesExceeded:o}=q(i),d=$((()=>l.entry.renewed?"Already renewed":l.entry.renewRequested?"Renewal Requested":o.value?"Too Many Requests":`Request Renewal for ${ne}`)),v=()=>{const e=document.activeElement;e instanceof HTMLElement&&e.blur(),n.value=!0,s.value?.showModal()},c=()=>{s.value?.close(),n.value=!1},y=_(),m=e=>y.value=e;return(t,l)=>(a(),r(R,null,[e("article",Me,[e("p",Le,u(t.entry.CensusPlayer),1),e("div",Ne,[t.entry.CensusDiscord?(a(),r("div",De,[Te,e("div",null,u(t.entry.CensusDiscord),1)])):b("",!0),t.entry.CensusReddit?(a(),r("div",Ue,[Ve,e("div",We,[w(D,{wikitext:t.entry.CensusReddit},null,8,["wikitext"])])])):b("",!0),t.entry.CensusFriend?(a(),r("div",qe,[Ae,e("div",Fe,u(t.entry.CensusFriend),1)])):b("",!0),e("div",null,[ze,e("div",je,[w(D,{wikitext:t.entry.Name},null,8,["wikitext"])])]),e("div",null,[Ye,e("div",null,u(t.entry.System),1)]),e("div",null,[He,e("div",null,u(t.entry.Platform),1)]),e("div",null,[Je,e("div",null,u(t.entry.Mode),1)]),e("div",null,[Ke,e("div",null,u(t.entry.CensusArrival.toLocaleDateString()),1)])]),e("details",null,[Oe,e("article",Qe,[e("div",{"data-tooltip":d.value},[w(de,{"user-object":t.entry,"button-text":"Renew","button-text-failed":"Failed!","button-text-success":"Renewed!"},null,8,["user-object"])],8,Xe),e("button",{"data-tooltip":"Change Census Base",type:"button",onClick:v}," Change "),e("a",{href:`./form.html?update=${f(U)(t.entry.CensusPlayer)}`,"data-tooltip":"Update Census Base",role:"button",onClick:l[0]||(l[0]=e=>f(V)(t.entry))},"Update",8,Ze),w(A,{entry:t.entry,"data-tooltip":"New Census Base",text:"New"},null,8,["entry"])])])]),e("dialog",{ref_key:"changeBaseModal",ref:s,onClick:ae(c,["self"])},[n.value?(a(),I(Ee,{key:0,entry:t.entry,items:y.value,onClose:c,onReady:m},null,8,["entry","items"])):b("",!0)],512)],64))}}),et=L(Ge,[["__scopeId","data-v-47e411c5"]]),N=e=>(E("data-v-8e742d08"),e=e(),M(),e),tt=N((()=>e("h1",{class:"title"},"Eisvana Census Table",-1))),st={class:"layout-table"},nt={class:"top-row"},at=N((()=>e("option",{value:""},"All",-1))),ot=["value"],lt=N((()=>e("hr",null,null,-1))),rt={key:0,class:"census-items"},it=S({__name:"CensusTable",setup(t){const l=oe(),{censusData:s,availableRevisions:n}=q(l),i=_(""),o=_(""),d=_([]);function v({Name:e,CensusPlayer:a,CensusDiscord:t,CensusReddit:l,Mode:s,Platform:n,System:r,CensusFriend:u,CensusRenewal:d}){return!(i.value&&!d.includes(i.value))&&[e,a,t,l,s,n,r,u].map((e=>e?.trim().toLowerCase())).some((e=>e?.includes(o.value.toLowerCase())))}le((()=>i.value=n.value[0]?.toString()));const c=$((()=>i.value?s.value.filter((e=>e.CensusRenewal.includes(i.value))):s.value)),y=$((()=>c.value.length)),m=$((()=>c.value.filter(v).toReversed())),p=e=>d.value=e;return(t,l)=>(a(),r(R,null,[tt,e("div",st,[e("div",nt,[e("p",null,"Census count: "+u(y.value),1),e("div",null,[B(e("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),"aria-label":"Search Name",type:"search"},null,512),[[W,o.value,void 0,{trim:!0}]])]),e("div",null,[B(e("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>i.value=e),"aria-label":"Select Revision"},[at,(a(!0),r(R,null,P(f(n),(e=>(a(),r("option",{value:e},u(e),9,ot)))),256))],512),[[re,i.value,void 0,{trim:!0}]])])]),lt,w(ve,{data:m.value,"page-size":f(ce),onChange:p},null,8,["data","page-size"]),w(ue,null,{default:ie((()=>[f(s).length?(a(),r("div",rt,[(a(!0),r(R,null,P(d.value,(e=>(a(),I(et,{entry:e,key:e.CensusPlayer},null,8,["entry"])))),128))])):b("",!0)])),_:1})])],64))}}),mt=L(it,[["__scopeId","data-v-8e742d08"]]);export{mt as default};
